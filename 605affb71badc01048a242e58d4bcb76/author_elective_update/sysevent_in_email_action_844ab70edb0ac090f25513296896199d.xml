<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sysevent_in_email_action">
    <sysevent_in_email_action action="DELETE">
        <action>record_action</action>
        <active>true</active>
        <assignment_operator/>
        <condition_script/>
        <description/>
        <event_name>email.read</event_name>
        <filter_condition table="sys_email">direct=ratelock@movement.com^ORbodyLIKEtest-for-rate-lock^EQ<item endquery="false" field="direct" goto="false" newquery="false" operator="=" or="false" value="ratelock@movement.com"/>
            <item endquery="false" field="body" goto="false" newquery="false" operator="LIKE" or="true" value="test-for-rate-lock"/>
            <item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/>
        </filter_condition>
        <from/>
        <name>UPDATE: ratelock@movement.com</name>
        <order>98</order>
        <plus_address/>
        <reply_email/>
        <required_roles/>
        <script><![CDATA[var loan_number;

if (/[\d]{7}/gi.test(email.subject)) {
  loan_number = getLoanNumber(email.subject);
} else if (/[\d]{7}/gi.test(email.body_text)) {
  loan_number = getLoanNumber(email.body_text);
}

if (!/[\d]{7}/gi.test(loan_number)) {
  loan_number = null;
}

if (loan_number) {
  current.addQuery('loan_number', loan_number);
  current.addQuery('active', true);
  current.query();
}

function getLoanNumber(message) {
  var regex = /.*(?=([\d]{7})).*/gm;
  var matches = regex.exec(message);
  if (matches.length > 0) {
    for (var i=0;i<matches.length;i++) {
      if (/^[\d]{7}$/gm.test(matches[i])) {
        return matches[i].trim();
      }
    }
  }
  return;
}]]></script>
        <stop_processing>false</stop_processing>
        <sys_class_name>sysevent_in_email_action</sys_class_name>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-01-01 20:28:57</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>844ab70edb0ac090f25513296896199d</sys_id>
        <sys_mod_count>17</sys_mod_count>
        <sys_name>UPDATE: ratelock@movement.com</sys_name>
        <sys_overrides/>
        <sys_package display_value="Ratelock" source="x_momo_ratelock">605affb71badc01048a242e58d4bcb76</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Ratelock">605affb71badc01048a242e58d4bcb76</sys_scope>
        <sys_update_name>sysevent_in_email_action_844ab70edb0ac090f25513296896199d</sys_update_name>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-01-02 10:06:03</sys_updated_on>
        <table>x_momo_ratelock_ticket</table>
        <template/>
        <type/>
    </sysevent_in_email_action>
    <sys_translated_text action="DELETE" query="documentkey=844ab70edb0ac090f25513296896199d"/>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Ratelock">605affb71badc01048a242e58d4bcb76</application>
        <file_path/>
        <instance_id>94e8281edbb7470060a6f0e5bf9619f6</instance_id>
        <instance_name>movementdev</instance_name>
        <name>sysevent_in_email_action_844ab70edb0ac090f25513296896199d</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_in_email_action"&gt;&lt;sysevent_in_email_action action="INSERT_OR_UPDATE"&gt;&lt;action&gt;record_action&lt;/action&gt;&lt;active&gt;true&lt;/active&gt;&lt;assignment_operator/&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;email.read&lt;/event_name&gt;&lt;filter_condition table="sys_email"&gt;direct=ratelock@movement.com^ORbodyLIKEtest-for-rate-lock^EQ&lt;item endquery="false" field="direct" goto="false" newquery="false" operator="=" or="false" value="ratelock@movement.com"/&gt;&lt;item endquery="false" field="body" goto="false" newquery="false" operator="LIKE" or="true" value="test-for-rate-lock"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/filter_condition&gt;&lt;from/&gt;&lt;name&gt;UPDATE: ratelock@movement.com&lt;/name&gt;&lt;order&gt;98&lt;/order&gt;&lt;plus_address/&gt;&lt;reply_email/&gt;&lt;required_roles/&gt;&lt;script&gt;&lt;![CDATA[var loan_number;

if (/[\d]{7}/gi.test(email.subject)) {
  loan_number = getLoanNumber(email.subject);
} else if (/[\d]{7}/gi.test(email.body_text)) {
  loan_number = getLoanNumber(email.body_text);
}

if (!/[\d]{7}/gi.test(loan_number)) {
  loan_number = null;
}

if (loan_number) {
  current.addQuery('loan_number', loan_number);
  current.addQuery('active', true);
  current.query();
}

function getLoanNumber(message) {
  var regex = /.*(?=([\d]{7})).*/gm;
  var matches = regex.exec(message);
  if (matches.length &gt; 0) {
    for (var i=0;i&lt;matches.length;i++) {
      if (/^[\d]{7}$/gm.test(matches[i])) {
        return matches[i].trim();
      }
    }
  }
  return;
}]]&gt;&lt;/script&gt;&lt;stop_processing&gt;false&lt;/stop_processing&gt;&lt;sys_class_name&gt;sysevent_in_email_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;douglas.schamberg&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2020-01-01 20:28:57&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;844ab70edb0ac090f25513296896199d&lt;/sys_id&gt;&lt;sys_mod_count&gt;17&lt;/sys_mod_count&gt;&lt;sys_name&gt;UPDATE: ratelock@movement.com&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Ratelock" source="x_momo_ratelock"&gt;605affb71badc01048a242e58d4bcb76&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Ratelock"&gt;605affb71badc01048a242e58d4bcb76&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_in_email_action_844ab70edb0ac090f25513296896199d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;douglas.schamberg&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2020-01-02 10:06:03&lt;/sys_updated_on&gt;&lt;table&gt;x_momo_ratelock_ticket&lt;/table&gt;&lt;template/&gt;&lt;type/&gt;&lt;/sysevent_in_email_action&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=844ab70edb0ac090f25513296896199d"/&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-359361942</payload_hash>
        <record_name>UPDATE: ratelock@movement.com</record_name>
        <reverted_from/>
        <source>a45affb71badc01048a242e58d4bcb78</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-01-02 10:06:04</sys_created_on>
        <sys_id>f716be16dbc60490f2551329689619c6</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>16f65b822e50000001</sys_recorded_at>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-01-02 10:06:04</sys_updated_on>
        <type>Inbound Email Actions</type>
        <update_guid>bf16be16a4c604900e0765dbf87249c5</update_guid>
        <update_guid_history>bf16be16a4c604900e0765dbf87249c5:-359361942,def43ad28bc604903fa7468b7dcfc2a6:-1635640790,fdf640d68f8ac090525dd9b9063eb76b:-797844983,f2860096b88ac090c2b7892a0b9d88a2:856120569,8e76c0960b8ac090984694013ff2520a:-1875408482,73d58416908ac09002e3448ca24e4b73:1137902389,2c950c161b8ac090b650f625a0a5dbe0:-932420081,edd44816a48ac090df5620586a4743cd:-2140750575,50c40416198ac0908920cea0eb382a1b:-932420081,760304120f8ac090069c48ebe0346415:909936115,5f128012608ac0905cf40beb2c22f85a:-932420081,3b81cc9e1b4ac090ddc898f239099061:-171435524,621148dede4ac0901acb6ce9195e4e11:224121057,9b9d7f0a414ac090dbb9ec0c3e3af862:1367577508,3f8dff8a074ac090c96b49c091e13029:-2019869885,bebb3f0a0d4ac0906013667fec5d1a47:845122395,646bf30a614ac090c538dd0e45d669d3:1248242587,ae1bbfc6aa4ac090d20c839cba1e8cba:-449732312</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-01-02 11:35:26</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_db_object display_value="" name="sysevent_in_email_action">sysevent_in_email_action</sys_db_object>
        <sys_id>296124bf861641b08db0704a66a5e610</sys_id>
        <sys_metadata>844ab70edb0ac090f25513296896199d</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>UPDATE: ratelock@movement.com</sys_name>
        <sys_package display_value="Ratelock" source="x_momo_ratelock">605affb71badc01048a242e58d4bcb76</sys_package>
        <sys_parent display_value="">744853641b71c41048a242e58d4bcb29</sys_parent>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Ratelock">605affb71badc01048a242e58d4bcb76</sys_scope>
        <sys_scope_delete display_value="">57712118eaee4a49ae47b2048a14ac31</sys_scope_delete>
        <sys_update_name>sysevent_in_email_action_844ab70edb0ac090f25513296896199d</sys_update_name>
        <sys_update_version display_value="sysevent_in_email_action_844ab70edb0ac090f25513296896199d">f716be16dbc60490f2551329689619c6</sys_update_version>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-01-02 11:35:26</sys_updated_on>
    </sys_metadata_delete>
</record_update>
