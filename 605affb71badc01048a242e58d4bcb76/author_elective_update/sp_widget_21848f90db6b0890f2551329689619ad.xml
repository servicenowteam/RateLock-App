<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="DELETE">
        <category>custom</category>
        <client_script><![CDATA[function ($scope, $rootScope) {
  /* widget controller */
  var c = this;
  $scope.buttons = $scope.data.buttons;
  $rootScope.$on('ratelock.ticket-actions', function () {
    $scope.server.refresh().then(function (results) {
      $scope.buttons = results.data.buttons;
    });
  })
  $scope.filterList = function (name) {
    $rootScope.$broadcast('ratelock.quick-filter', name);

    $scope.buttons = $scope.buttons.map(function (btn) {

      if (name == btn.query && !btn.isClicked) {
        btn.isClicked = true;
      } else {
        btn.isClicked = false;
      }
      return btn;
    });
  }
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.panel {&#13;
	border: none;&#13;
}&#13;
&#13;
@media screen and (max-width: 1000px) {&#13;
  .side-panel-container {&#13;
  	display: none;&#13;
    visibility: hidden;&#13;
  }&#13;
}&#13;
&#13;
&#13;
.panel-body.side-panel {&#13;
	padding: 0px 0px 30px 0px;&#13;
}&#13;
&#13;
.col-xs-12.btn-container {&#13;
	padding-left: 5px;&#13;
  padding-right: 5px;&#13;
  margin-bottom: 5px;&#13;
}&#13;
&#13;
.btn.btn-outline:hover {&#13;
  border-color: $brand-primary;&#13;
  color: #fff;&#13;
	background: $brand-primary;&#13;
  &#13;
  border-style: solid;&#13;
  border-radius: 5px;&#13;
  border-width: 1px;&#13;
  &#13;
  -webkit-transition: all .3s ease-out;&#13;
  -moz-transition: all .3s ease-out;&#13;
  -ms-transition: all .3s ease-out;&#13;
  transition: all .3s ease-out;&#13;
}&#13;
&#13;
.btn.btn-outline:focus {&#13;
	border: 1px solid $brand-primary;&#13;
  box-shadow: 0px 0px 5px $brand-primary;&#13;
  outline: none;&#13;
}&#13;
&#13;
.btn.btn-outline{&#13;
  background: #fff;&#13;
  &#13;
  border-style: solid;&#13;
  border-radius: 5px;&#13;
  border-width: 1px;&#13;
  &#13;
  -webkit-transition: all .3s ease-out;&#13;
  -moz-transition: all .3s ease-out;&#13;
  -ms-transition: all .3s ease-out;&#13;
  transition: all .3s ease-out;&#13;
  border-color: $brand-primary;&#13;
  color: $brand-primary;&#13;
}&#13;
&#13;
.btn-selected {&#13;
	background: $brand-primary !important;&#13;
 	color: #fff !important;&#13;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Ratelock Quick Filter</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function(){
  data.table = options.table || $sp.getParameter('table');
  if (input) {
    var _button = input.button;
    if (!_button) return data.buttons;
    data.buttons = data.buttons.map(function(button) {
      if (button.name === input.button.name) {
        var aggr = getAggregateArr(_button.name);
        var btn =  createButton(data.table, _button.name, _button.query, _button.isClicked, aggr);
        return btn;
      }
      return button
    });
  } else {
    data.buttons = options.buttons.map(function(button) {
      return createButton(data.table, button.name, button.query, button.isClicked, button.aggregates);
    });
  }

  function createEncodedQuery(query_schema) {
    var queries = query_schema || [];
    var url = [];
    for (var i in queries) {
      var q = queries[i];
      url.push(q.column + q.operator + q.value);
    }
    return url.join('^');
  }

  function getAggregateArr(name) {
    var button = options.buttons.find(function(button) {
      return button.name === name;
    });

    return button ? button.aggregates : [];
  }

  function createButton(table, name, query, isClicked, aggregates) {
    var ga = new GlideAggregate(table);
    var encoded_query = createEncodedQuery(aggregates);
    ga.addAggregate('COUNT');
    ga.addEncodedQuery(encoded_query);
    ga.query();
    var count = ga.next() ? ga.getAggregate('COUNT') : 0;
    return {
      count: count,
      name: name,
      query: encoded_query,
      isClicked: isClicked
    };
  }

  
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-03-10 19:35:19</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>21848f90db6b0890f2551329689619ad</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Ratelock Quick Filter</sys_name>
        <sys_package display_value="Ratelock" source="x_momo_ratelock">605affb71badc01048a242e58d4bcb76</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Ratelock">605affb71badc01048a242e58d4bcb76</sys_scope>
        <sys_update_name>sp_widget_21848f90db6b0890f2551329689619ad</sys_update_name>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-03-10 19:35:19</sys_updated_on>
        <template><![CDATA[<div class="panel panel-primary side-panel-container">
  <div class="panel-heading">
    <div class="sp-attachments-header panel-title pull-left">
      ${Quick Filter}
    </div>
    <div class="clearfix"></div>
  </div>
  <div class="panel-body side-panel padder-t padder-b-none">
    <div ng-repeat="btn in buttons" class="col-xs-12 btn-container">
      <button 
        type="button" 
        ng-class="{'btn-selected': btn.isClicked}" 
        class="btn btn-block btn-outline" 
        ng-click="filterList(btn.isClicked ? null : btn.query)">
        <span ng-class="{'pull-left': btn.query !== 'default'}">{{btn.name}}</span>
        <span class="pull-right">{{btn.count}}</span>
      </button>
    </div>
  </div>
</div>]]></template>
    </sp_widget>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Ratelock">605affb71badc01048a242e58d4bcb76</application>
        <file_path/>
        <instance_id>94e8281edbb7470060a6f0e5bf9619f6</instance_id>
        <instance_name>movementdev</instance_name>
        <name>sp_widget_21848f90db6b0890f2551329689619ad</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function ($scope, $rootScope) {
  /* widget controller */
  var c = this;
  $scope.buttons = $scope.data.buttons;
  $rootScope.$on('ratelock.ticket-actions', function () {
    $scope.server.refresh().then(function (results) {
      $scope.buttons = results.data.buttons;
    });
  })
  $scope.filterList = function (name) {
    $rootScope.$broadcast('ratelock.quick-filter', name);

    $scope.buttons = $scope.buttons.map(function (btn) {

      if (name == btn.query &amp;&amp; !btn.isClicked) {
        btn.isClicked = true;
      } else {
        btn.isClicked = false;
      }
      return btn;
    });
  }
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.panel {&amp;#13;
	border: none;&amp;#13;
}&amp;#13;
&amp;#13;
@media screen and (max-width: 1000px) {&amp;#13;
  .side-panel-container {&amp;#13;
  	display: none;&amp;#13;
    visibility: hidden;&amp;#13;
  }&amp;#13;
}&amp;#13;
&amp;#13;
&amp;#13;
.panel-body.side-panel {&amp;#13;
	padding: 0px 0px 30px 0px;&amp;#13;
}&amp;#13;
&amp;#13;
.col-xs-12.btn-container {&amp;#13;
	padding-left: 5px;&amp;#13;
  padding-right: 5px;&amp;#13;
  margin-bottom: 5px;&amp;#13;
}&amp;#13;
&amp;#13;
.btn.btn-outline:hover {&amp;#13;
  border-color: $brand-primary;&amp;#13;
  color: #fff;&amp;#13;
	background: $brand-primary;&amp;#13;
  &amp;#13;
  border-style: solid;&amp;#13;
  border-radius: 5px;&amp;#13;
  border-width: 1px;&amp;#13;
  &amp;#13;
  -webkit-transition: all .3s ease-out;&amp;#13;
  -moz-transition: all .3s ease-out;&amp;#13;
  -ms-transition: all .3s ease-out;&amp;#13;
  transition: all .3s ease-out;&amp;#13;
}&amp;#13;
&amp;#13;
.btn.btn-outline:focus {&amp;#13;
	border: 1px solid $brand-primary;&amp;#13;
  box-shadow: 0px 0px 5px $brand-primary;&amp;#13;
  outline: none;&amp;#13;
}&amp;#13;
&amp;#13;
.btn.btn-outline{&amp;#13;
  background: #fff;&amp;#13;
  &amp;#13;
  border-style: solid;&amp;#13;
  border-radius: 5px;&amp;#13;
  border-width: 1px;&amp;#13;
  &amp;#13;
  -webkit-transition: all .3s ease-out;&amp;#13;
  -moz-transition: all .3s ease-out;&amp;#13;
  -ms-transition: all .3s ease-out;&amp;#13;
  transition: all .3s ease-out;&amp;#13;
  border-color: $brand-primary;&amp;#13;
  color: $brand-primary;&amp;#13;
}&amp;#13;
&amp;#13;
.btn-selected {&amp;#13;
	background: $brand-primary !important;&amp;#13;
 	color: #fff !important;&amp;#13;
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id/&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {  }]]&gt;&lt;/link&gt;&lt;name&gt;Ratelock Quick Filter&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function(){
  data.table = options.table || $sp.getParameter('table');
  if (input) {
    var _button = input.button;
    if (!_button) return data.buttons;
    data.buttons = data.buttons.map(function(button) {
      if (button.name === input.button.name) {
        var aggr = getAggregateArr(_button.name);
        var btn =  createButton(data.table, _button.name, _button.query, _button.isClicked, aggr);
        return btn;
      }
      return button
    });
  } else {
    data.buttons = options.buttons.map(function(button) {
      return createButton(data.table, button.name, button.query, button.isClicked, button.aggregates);
    });
  }

  function createEncodedQuery(query_schema) {
    var queries = query_schema || [];
    var url = [];
    for (var i in queries) {
      var q = queries[i];
      url.push(q.column + q.operator + q.value);
    }
    return url.join('^');
  }

  function getAggregateArr(name) {
    var button = options.buttons.find(function(button) {
      return button.name === name;
    });

    return button ? button.aggregates : [];
  }

  function createButton(table, name, query, isClicked, aggregates) {
    var ga = new GlideAggregate(table);
    var encoded_query = createEncodedQuery(aggregates);
    ga.addAggregate('COUNT');
    ga.addEncodedQuery(encoded_query);
    ga.query();
    var count = ga.next() ? ga.getAggregate('COUNT') : 0;
    return {
      count: count,
      name: name,
      query: encoded_query,
      isClicked: isClicked
    };
  }

  
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;douglas.schamberg&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2020-03-10 19:35:19&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;21848f90db6b0890f2551329689619ad&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Ratelock Quick Filter&lt;/sys_name&gt;&lt;sys_package display_value="Ratelock" source="x_momo_ratelock"&gt;605affb71badc01048a242e58d4bcb76&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Ratelock"&gt;605affb71badc01048a242e58d4bcb76&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_21848f90db6b0890f2551329689619ad&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;douglas.schamberg&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2020-03-10 19:35:19&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div class="panel panel-primary side-panel-container"&gt;
  &lt;div class="panel-heading"&gt;
    &lt;div class="sp-attachments-header panel-title pull-left"&gt;
      ${Quick Filter}
    &lt;/div&gt;
    &lt;div class="clearfix"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="panel-body side-panel padder-t padder-b-none"&gt;
    &lt;div ng-repeat="btn in buttons" class="col-xs-12 btn-container"&gt;
      &lt;button 
        type="button" 
        ng-class="{'btn-selected': btn.isClicked}" 
        class="btn btn-block btn-outline" 
        ng-click="filterList(btn.isClicked ? null : btn.query)"&gt;
        &lt;span ng-class="{'pull-left': btn.query !== 'default'}"&gt;{{btn.name}}&lt;/span&gt;
        &lt;span class="pull-right"&gt;{{btn.count}}&lt;/span&gt;
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-1311921354</payload_hash>
        <record_name>Ratelock Quick Filter</record_name>
        <reverted_from/>
        <source>74fc5f651b5a401048a242e58d4bcbbc</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-03-10 19:35:19</sys_created_on>
        <sys_id>2d848f90db6b0890f2551329689619ae</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>170c5f1bdb70000001</sys_recorded_at>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-03-10 19:35:19</sys_updated_on>
        <type>Widget</type>
        <update_guid>25848f90906b089027002a0e2e62c7ae</update_guid>
        <update_guid_history>25848f90906b089027002a0e2e62c7ae:-1311921354</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="">41e44fd0db6b0890f2551329689619e7</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>douglas.schamberg</sys_created_by>
        <sys_created_on>2020-03-10 19:36:55</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_db_object display_value="" name="sp_widget">sp_widget</sys_db_object>
        <sys_id>1a46d70ecfae411e98a3445a0752a044</sys_id>
        <sys_metadata>21848f90db6b0890f2551329689619ad</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Ratelock Quick Filter</sys_name>
        <sys_package display_value="Ratelock" source="x_momo_ratelock">605affb71badc01048a242e58d4bcb76</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Ratelock">605affb71badc01048a242e58d4bcb76</sys_scope>
        <sys_scope_delete display_value="">57712118eaee4a49ae47b2048a14ac31</sys_scope_delete>
        <sys_update_name>sp_widget_21848f90db6b0890f2551329689619ad</sys_update_name>
        <sys_update_version display_value="sp_widget_21848f90db6b0890f2551329689619ad">2d848f90db6b0890f2551329689619ae</sys_update_version>
        <sys_updated_by>douglas.schamberg</sys_updated_by>
        <sys_updated_on>2020-03-10 19:36:55</sys_updated_on>
    </sys_metadata_delete>
</record_update>
